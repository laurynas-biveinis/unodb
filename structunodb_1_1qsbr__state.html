<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UnoDB: unodb::qsbr_state Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">UnoDB
   </div>
   <div id="projectbrief">Adaptive Radix Tree in C++, optionally with Optimistic Lock Coupling</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('structunodb_1_1qsbr__state.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="structunodb_1_1qsbr__state-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">unodb::qsbr_state Struct Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Global QSBR state in a single 64-bit machine word.  
 <a href="structunodb_1_1qsbr__state.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="qsbr_8hpp_source.html">qsbr.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a9ded9024be69a382b3a9fc65892ea7cc" id="r_a9ded9024be69a382b3a9fc65892ea7cc"><td class="memItemLeft" align="right" valign="top"><a id="a9ded9024be69a382b3a9fc65892ea7cc" name="a9ded9024be69a382b3a9fc65892ea7cc"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><b>type</b> = std::uint64_t</td></tr>
<tr class="memdesc:a9ded9024be69a382b3a9fc65892ea7cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Underlying type for the state word. <br /></td></tr>
<tr class="separator:a9ded9024be69a382b3a9fc65892ea7cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a95e20672c7b07408ea8aa37a11a49bfa" id="r_a95e20672c7b07408ea8aa37a11a49bfa"><td class="memItemLeft" align="right" valign="top"><a id="a95e20672c7b07408ea8aa37a11a49bfa" name="a95e20672c7b07408ea8aa37a11a49bfa"></a>
static constexpr <a class="el" href="classunodb_1_1detail_1_1qsbr__epoch.html">detail::qsbr_epoch</a>&#160;</td><td class="memItemRight" valign="bottom"><b>get_epoch</b> (<a class="el" href="structunodb_1_1qsbr__state.html#a9ded9024be69a382b3a9fc65892ea7cc">type</a> word) noexcept</td></tr>
<tr class="memdesc:a95e20672c7b07408ea8aa37a11a49bfa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the epoch from <em>word</em>. <br /></td></tr>
<tr class="separator:a95e20672c7b07408ea8aa37a11a49bfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68caabb03695c7ec2deea7864d7e1ca8" id="r_a68caabb03695c7ec2deea7864d7e1ca8"><td class="memItemLeft" align="right" valign="top"><a id="a68caabb03695c7ec2deea7864d7e1ca8" name="a68caabb03695c7ec2deea7864d7e1ca8"></a>
static constexpr <a class="el" href="namespaceunodb_1_1detail.html#a78bbb5caf501cb09276604dab64723bf">detail::qsbr_thread_count_type</a>&#160;</td><td class="memItemRight" valign="bottom"><b>get_thread_count</b> (<a class="el" href="structunodb_1_1qsbr__state.html#a9ded9024be69a382b3a9fc65892ea7cc">type</a> word) noexcept</td></tr>
<tr class="memdesc:a68caabb03695c7ec2deea7864d7e1ca8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the total thread count from <em>word</em>. <br /></td></tr>
<tr class="separator:a68caabb03695c7ec2deea7864d7e1ca8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa1c95b9791f14c24bd6dd6fae173f82" id="r_aaa1c95b9791f14c24bd6dd6fae173f82"><td class="memItemLeft" align="right" valign="top"><a id="aaa1c95b9791f14c24bd6dd6fae173f82" name="aaa1c95b9791f14c24bd6dd6fae173f82"></a>
static constexpr <a class="el" href="namespaceunodb_1_1detail.html#a78bbb5caf501cb09276604dab64723bf">detail::qsbr_thread_count_type</a>&#160;</td><td class="memItemRight" valign="bottom"><b>get_threads_in_previous_epoch</b> (<a class="el" href="structunodb_1_1qsbr__state.html#a9ded9024be69a382b3a9fc65892ea7cc">type</a> word) noexcept</td></tr>
<tr class="memdesc:aaa1c95b9791f14c24bd6dd6fae173f82"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the count of threads in the previous epoch from <em>word</em>. <br /></td></tr>
<tr class="separator:aaa1c95b9791f14c24bd6dd6fae173f82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34cec6a5c7739cb36a3df6041e45e118" id="r_a34cec6a5c7739cb36a3df6041e45e118"><td class="memItemLeft" align="right" valign="top"><a id="a34cec6a5c7739cb36a3df6041e45e118" name="a34cec6a5c7739cb36a3df6041e45e118"></a>
static constexpr bool&#160;</td><td class="memItemRight" valign="bottom"><b>single_thread_mode</b> (<a class="el" href="structunodb_1_1qsbr__state.html#a9ded9024be69a382b3a9fc65892ea7cc">type</a> word) noexcept</td></tr>
<tr class="memdesc:a34cec6a5c7739cb36a3df6041e45e118"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the count of threads in if <em>word</em> is 0 or 1. <br /></td></tr>
<tr class="separator:a34cec6a5c7739cb36a3df6041e45e118"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c87e417cf41976cfcb6fdeaa4693338" id="r_a9c87e417cf41976cfcb6fdeaa4693338"><td class="memItemLeft" align="right" valign="top"><a id="a9c87e417cf41976cfcb6fdeaa4693338" name="a9c87e417cf41976cfcb6fdeaa4693338"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><b>dump</b> (std::ostream &amp;os, <a class="el" href="structunodb_1_1qsbr__state.html#a9ded9024be69a382b3a9fc65892ea7cc">type</a> word)</td></tr>
<tr class="memdesc:a9c87e417cf41976cfcb6fdeaa4693338"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output QSBR state in <em>word</em> to <em>os</em>, for debugging only. <br /></td></tr>
<tr class="separator:a9c87e417cf41976cfcb6fdeaa4693338"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-static-methods" name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:a5b5df90060e7adb64233092f7c71a059" id="r_a5b5df90060e7adb64233092f7c71a059"><td class="memItemLeft" align="right" valign="top"><a id="a5b5df90060e7adb64233092f7c71a059" name="a5b5df90060e7adb64233092f7c71a059"></a>
static constexpr <a class="el" href="classunodb_1_1detail_1_1qsbr__epoch.html">detail::qsbr_epoch</a>&#160;</td><td class="memItemRight" valign="bottom"><b>do_get_epoch</b> (<a class="el" href="structunodb_1_1qsbr__state.html#a9ded9024be69a382b3a9fc65892ea7cc">type</a> word) noexcept</td></tr>
<tr class="memdesc:a5b5df90060e7adb64233092f7c71a059"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract the epoch from <em>word</em>. <br /></td></tr>
<tr class="separator:a5b5df90060e7adb64233092f7c71a059"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab152fb661e68d7670fd6eb4d425ae968" id="r_ab152fb661e68d7670fd6eb4d425ae968"><td class="memItemLeft" align="right" valign="top"><a id="ab152fb661e68d7670fd6eb4d425ae968" name="ab152fb661e68d7670fd6eb4d425ae968"></a>
static constexpr <a class="el" href="namespaceunodb_1_1detail.html#a78bbb5caf501cb09276604dab64723bf">detail::qsbr_thread_count_type</a>&#160;</td><td class="memItemRight" valign="bottom"><b>do_get_thread_count</b> (<a class="el" href="structunodb_1_1qsbr__state.html#a9ded9024be69a382b3a9fc65892ea7cc">type</a> word) noexcept</td></tr>
<tr class="memdesc:ab152fb661e68d7670fd6eb4d425ae968"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract the total thread count from <em>word</em>. <br /></td></tr>
<tr class="separator:ab152fb661e68d7670fd6eb4d425ae968"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9945790ec8f3aab1cd31b85b6a99ac9f" id="r_a9945790ec8f3aab1cd31b85b6a99ac9f"><td class="memItemLeft" align="right" valign="top"><a id="a9945790ec8f3aab1cd31b85b6a99ac9f" name="a9945790ec8f3aab1cd31b85b6a99ac9f"></a>
static constexpr <a class="el" href="namespaceunodb_1_1detail.html#a78bbb5caf501cb09276604dab64723bf">detail::qsbr_thread_count_type</a>&#160;</td><td class="memItemRight" valign="bottom"><b>do_get_threads_in_previous_epoch</b> (<a class="el" href="structunodb_1_1qsbr__state.html#a9ded9024be69a382b3a9fc65892ea7cc">type</a> word) noexcept</td></tr>
<tr class="memdesc:a9945790ec8f3aab1cd31b85b6a99ac9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract the count of threads in the previous epoch from <em>word</em>. <br /></td></tr>
<tr class="separator:a9945790ec8f3aab1cd31b85b6a99ac9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d1372d43294c341e541c47e23919c2e" id="r_a2d1372d43294c341e541c47e23919c2e"><td class="memItemLeft" align="right" valign="top"><a id="a2d1372d43294c341e541c47e23919c2e" name="a2d1372d43294c341e541c47e23919c2e"></a>
static constexpr <a class="el" href="structunodb_1_1qsbr__state.html#a9ded9024be69a382b3a9fc65892ea7cc">type</a>&#160;</td><td class="memItemRight" valign="bottom"><b>make_from_epoch</b> (<a class="el" href="classunodb_1_1detail_1_1qsbr__epoch.html">detail::qsbr_epoch</a> epoch) noexcept</td></tr>
<tr class="memdesc:a2d1372d43294c341e541c47e23919c2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make a state word from <em>epoch</em>. <br /></td></tr>
<tr class="separator:a2d1372d43294c341e541c47e23919c2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a892b5c799cddefcf3427f08572744402" id="r_a892b5c799cddefcf3427f08572744402"><td class="memItemLeft" align="right" valign="top"><a id="a892b5c799cddefcf3427f08572744402" name="a892b5c799cddefcf3427f08572744402"></a>
static constexpr <a class="el" href="structunodb_1_1qsbr__state.html#a9ded9024be69a382b3a9fc65892ea7cc">type</a>&#160;</td><td class="memItemRight" valign="bottom"><b>inc_thread_count</b> (<a class="el" href="structunodb_1_1qsbr__state.html#a9ded9024be69a382b3a9fc65892ea7cc">type</a> word) noexcept</td></tr>
<tr class="memdesc:a892b5c799cddefcf3427f08572744402"><td class="mdescLeft">&#160;</td><td class="mdescRight">Increment the thread count in <em>word</em> by one. <br /></td></tr>
<tr class="separator:a892b5c799cddefcf3427f08572744402"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4dde107e5a1246b4e17e8293f2a8359" id="r_aa4dde107e5a1246b4e17e8293f2a8359"><td class="memItemLeft" align="right" valign="top"><a id="aa4dde107e5a1246b4e17e8293f2a8359" name="aa4dde107e5a1246b4e17e8293f2a8359"></a>
static constexpr <a class="el" href="structunodb_1_1qsbr__state.html#a9ded9024be69a382b3a9fc65892ea7cc">type</a>&#160;</td><td class="memItemRight" valign="bottom"><b>dec_thread_count</b> (<a class="el" href="structunodb_1_1qsbr__state.html#a9ded9024be69a382b3a9fc65892ea7cc">type</a> word) noexcept</td></tr>
<tr class="memdesc:aa4dde107e5a1246b4e17e8293f2a8359"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrement the thread count in <em>word</em> by one. <br /></td></tr>
<tr class="separator:aa4dde107e5a1246b4e17e8293f2a8359"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51abec9f3ae5fdc60a7a837255a7b907" id="r_a51abec9f3ae5fdc60a7a837255a7b907"><td class="memItemLeft" align="right" valign="top"><a id="a51abec9f3ae5fdc60a7a837255a7b907" name="a51abec9f3ae5fdc60a7a837255a7b907"></a>
static constexpr <a class="el" href="structunodb_1_1qsbr__state.html#a9ded9024be69a382b3a9fc65892ea7cc">type</a>&#160;</td><td class="memItemRight" valign="bottom"><b>inc_thread_count_and_threads_in_previous_epoch</b> (<a class="el" href="structunodb_1_1qsbr__state.html#a9ded9024be69a382b3a9fc65892ea7cc">type</a> word) noexcept</td></tr>
<tr class="memdesc:a51abec9f3ae5fdc60a7a837255a7b907"><td class="mdescLeft">&#160;</td><td class="mdescRight">Increment both the thread count and threads in previous epoch in <em>word</em>. <br /></td></tr>
<tr class="separator:a51abec9f3ae5fdc60a7a837255a7b907"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a026f7e459c9df2a48e975397573c537a" id="r_a026f7e459c9df2a48e975397573c537a"><td class="memItemLeft" align="right" valign="top"><a id="a026f7e459c9df2a48e975397573c537a" name="a026f7e459c9df2a48e975397573c537a"></a>
static constexpr <a class="el" href="structunodb_1_1qsbr__state.html#a9ded9024be69a382b3a9fc65892ea7cc">type</a>&#160;</td><td class="memItemRight" valign="bottom"><b>dec_thread_count_and_threads_in_previous_epoch</b> (<a class="el" href="structunodb_1_1qsbr__state.html#a9ded9024be69a382b3a9fc65892ea7cc">type</a> word) noexcept</td></tr>
<tr class="memdesc:a026f7e459c9df2a48e975397573c537a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrement both the thread count and threads in previous epoch in <em>word</em>. <br /></td></tr>
<tr class="separator:a026f7e459c9df2a48e975397573c537a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bb7a51ec18a83e065f535b53395f3fc" id="r_a4bb7a51ec18a83e065f535b53395f3fc"><td class="memItemLeft" align="right" valign="top"><a id="a4bb7a51ec18a83e065f535b53395f3fc" name="a4bb7a51ec18a83e065f535b53395f3fc"></a>
static constexpr <a class="el" href="structunodb_1_1qsbr__state.html#a9ded9024be69a382b3a9fc65892ea7cc">type</a>&#160;</td><td class="memItemRight" valign="bottom"><b>inc_epoch_reset_previous</b> (<a class="el" href="structunodb_1_1qsbr__state.html#a9ded9024be69a382b3a9fc65892ea7cc">type</a> word) noexcept</td></tr>
<tr class="memdesc:a4bb7a51ec18a83e065f535b53395f3fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Increment the epoch and reset the threads in previous epoch count to the total thread count. <br /></td></tr>
<tr class="separator:a4bb7a51ec18a83e065f535b53395f3fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95d19e99d8a76c15a1f6060bff5450b2" id="r_a95d19e99d8a76c15a1f6060bff5450b2"><td class="memItemLeft" align="right" valign="top"><a id="a95d19e99d8a76c15a1f6060bff5450b2" name="a95d19e99d8a76c15a1f6060bff5450b2"></a>
static constexpr <a class="el" href="structunodb_1_1qsbr__state.html#a9ded9024be69a382b3a9fc65892ea7cc">type</a>&#160;</td><td class="memItemRight" valign="bottom"><b>inc_epoch_dec_thread_count_reset_previous</b> (<a class="el" href="structunodb_1_1qsbr__state.html#a9ded9024be69a382b3a9fc65892ea7cc">type</a> word) noexcept</td></tr>
<tr class="memdesc:a95d19e99d8a76c15a1f6060bff5450b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Increment the epoch, decrement the thread count, and reset the threads in previous epoch to the new thread count. <br /></td></tr>
<tr class="separator:a95d19e99d8a76c15a1f6060bff5450b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3047665d6c9cb754fde07c314e7656ac" id="r_a3047665d6c9cb754fde07c314e7656ac"><td class="memItemLeft" align="right" valign="top"><a id="a3047665d6c9cb754fde07c314e7656ac" name="a3047665d6c9cb754fde07c314e7656ac"></a>
static constexpr <a class="el" href="structunodb_1_1qsbr__state.html#a9ded9024be69a382b3a9fc65892ea7cc">type</a>&#160;</td><td class="memItemRight" valign="bottom"><b>dec_thread_count_threads_in_previous_epoch_maybe_advance</b> (<a class="el" href="structunodb_1_1qsbr__state.html#a9ded9024be69a382b3a9fc65892ea7cc">type</a> word, bool advance_epoch) noexcept</td></tr>
<tr class="memdesc:a3047665d6c9cb754fde07c314e7656ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrement thread counts in <em>word</em> while optionally advancing the epoch if <em>advance_epoch</em> is set. <br /></td></tr>
<tr class="separator:a3047665d6c9cb754fde07c314e7656ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab46c5fe15d36c12d619713e696a48626" id="r_ab46c5fe15d36c12d619713e696a48626"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structunodb_1_1qsbr__state.html#a9ded9024be69a382b3a9fc65892ea7cc">qsbr_state::type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structunodb_1_1qsbr__state.html#ab46c5fe15d36c12d619713e696a48626">atomic_fetch_dec_threads_in_previous_epoch</a> (std::atomic&lt; <a class="el" href="structunodb_1_1qsbr__state.html#a9ded9024be69a382b3a9fc65892ea7cc">type</a> &gt; &amp;word) noexcept</td></tr>
<tr class="memdesc:ab46c5fe15d36c12d619713e696a48626"><td class="mdescLeft">&#160;</td><td class="mdescRight">Atomically decrement the number of threads in the previous epoch.  <br /></td></tr>
<tr class="separator:ab46c5fe15d36c12d619713e696a48626"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7ffe1a2893646634d39317db89e3570" id="r_ab7ffe1a2893646634d39317db89e3570"><td class="memItemLeft" align="right" valign="top"><a id="ab7ffe1a2893646634d39317db89e3570" name="ab7ffe1a2893646634d39317db89e3570"></a>
static constexpr void&#160;</td><td class="memItemRight" valign="bottom"><b>assert_invariants</b> (<a class="el" href="structunodb_1_1qsbr__state.html#a9ded9024be69a382b3a9fc65892ea7cc">type</a> word <a class="el" href="group__internal.html#ga635640d5d3b202d11b61c3730f6c2988">UNODB_DETAIL_USED_IN_DEBUG</a>) noexcept</td></tr>
<tr class="memdesc:ab7ffe1a2893646634d39317db89e3570"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assert that all invariants hold for <em>word</em>. <br /></td></tr>
<tr class="separator:ab7ffe1a2893646634d39317db89e3570"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-static-attribs" name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr class="memitem:a4e938754e4f52f03d657335a19c698e3" id="r_a4e938754e4f52f03d657335a19c698e3"><td class="memItemLeft" align="right" valign="top"><a id="a4e938754e4f52f03d657335a19c698e3" name="a4e938754e4f52f03d657335a19c698e3"></a>
static constexpr auto&#160;</td><td class="memItemRight" valign="bottom"><b>thread_count_mask</b> = <a class="el" href="namespaceunodb_1_1detail.html#ac7fc26e8bd3beb685ef91e9cc7e6672d">detail::max_qsbr_threads</a></td></tr>
<tr class="memdesc:a4e938754e4f52f03d657335a19c698e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mask for the thread count field. <br /></td></tr>
<tr class="separator:a4e938754e4f52f03d657335a19c698e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94eff2759b60138b7241f6bfb881d871" id="r_a94eff2759b60138b7241f6bfb881d871"><td class="memItemLeft" align="right" valign="top"><a id="a94eff2759b60138b7241f6bfb881d871" name="a94eff2759b60138b7241f6bfb881d871"></a>
static constexpr auto&#160;</td><td class="memItemRight" valign="bottom"><b>threads_in_previous_epoch_in_word_mask</b></td></tr>
<tr class="memdesc:a94eff2759b60138b7241f6bfb881d871"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mask for the threads in previous epoch field. <br /></td></tr>
<tr class="separator:a94eff2759b60138b7241f6bfb881d871"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d536e560819d5701ab0d4ad1fe874ba" id="r_a3d536e560819d5701ab0d4ad1fe874ba"><td class="memItemLeft" align="right" valign="top"><a id="a3d536e560819d5701ab0d4ad1fe874ba" name="a3d536e560819d5701ab0d4ad1fe874ba"></a>
static constexpr auto&#160;</td><td class="memItemRight" valign="bottom"><b>thread_count_in_word_offset</b> = 32U</td></tr>
<tr class="memdesc:a3d536e560819d5701ab0d4ad1fe874ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bit offset for the total thread count field. <br /></td></tr>
<tr class="separator:a3d536e560819d5701ab0d4ad1fe874ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8e68343fbb94686c58f6c5a50aac08c" id="r_ae8e68343fbb94686c58f6c5a50aac08c"><td class="memItemLeft" align="right" valign="top"><a id="ae8e68343fbb94686c58f6c5a50aac08c" name="ae8e68343fbb94686c58f6c5a50aac08c"></a>
static constexpr auto&#160;</td><td class="memItemRight" valign="bottom"><b>thread_count_in_word_mask</b></td></tr>
<tr class="memdesc:ae8e68343fbb94686c58f6c5a50aac08c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mask for the total thread count field. <br /></td></tr>
<tr class="separator:ae8e68343fbb94686c58f6c5a50aac08c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83fc5302dcb15e5cdd1c5d4355bf233a" id="r_a83fc5302dcb15e5cdd1c5d4355bf233a"><td class="memItemLeft" align="right" valign="top"><a id="a83fc5302dcb15e5cdd1c5d4355bf233a" name="a83fc5302dcb15e5cdd1c5d4355bf233a"></a>
static constexpr auto&#160;</td><td class="memItemRight" valign="bottom"><b>epoch_in_word_offset</b> = 62U</td></tr>
<tr class="memdesc:a83fc5302dcb15e5cdd1c5d4355bf233a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bit offset for the epoch field. <br /></td></tr>
<tr class="separator:a83fc5302dcb15e5cdd1c5d4355bf233a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89c75e71ef87b01b2e958dfe7d7b88ce" id="r_a89c75e71ef87b01b2e958dfe7d7b88ce"><td class="memItemLeft" align="right" valign="top"><a id="a89c75e71ef87b01b2e958dfe7d7b88ce" name="a89c75e71ef87b01b2e958dfe7d7b88ce"></a>
static constexpr auto&#160;</td><td class="memItemRight" valign="bottom"><b>one_thread_in_count</b></td></tr>
<tr class="memdesc:a89c75e71ef87b01b2e958dfe7d7b88ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Value to use for incrementing or decrementing the thread count by one. <br /></td></tr>
<tr class="separator:a89c75e71ef87b01b2e958dfe7d7b88ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a4dd4a202cfc58c779cbbae947b4b5d" id="r_a6a4dd4a202cfc58c779cbbae947b4b5d"><td class="memItemLeft" align="right" valign="top"><a id="a6a4dd4a202cfc58c779cbbae947b4b5d" name="a6a4dd4a202cfc58c779cbbae947b4b5d"></a>
static constexpr auto&#160;</td><td class="memItemRight" valign="bottom"><b>one_thread_and_one_in_previous</b></td></tr>
<tr class="memdesc:a6a4dd4a202cfc58c779cbbae947b4b5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Value to use for incrementing or decrementing both thread count and threads in previous epoch by one. <br /></td></tr>
<tr class="separator:a6a4dd4a202cfc58c779cbbae947b4b5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="friends" name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:ab3ca2a8465951cd7d4da8a212db6c8d1" id="r_ab3ca2a8465951cd7d4da8a212db6c8d1"><td class="memItemLeft" align="right" valign="top"><a id="ab3ca2a8465951cd7d4da8a212db6c8d1" name="ab3ca2a8465951cd7d4da8a212db6c8d1"></a>
class&#160;</td><td class="memItemRight" valign="bottom"><b>qsbr</b></td></tr>
<tr class="separator:ab3ca2a8465951cd7d4da8a212db6c8d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Global QSBR state in a single 64-bit machine word. </p>
<p>Bit allocation:</p><ul>
<li>0..29: Number of threads in the previous epoch</li>
<li>30..31: Unused</li>
<li>32..61: Total number of threads</li>
<li>62..63: Wrapping-around epoch counter</li>
</ul>
<p>Special state transitions: If a thread decrements the number of threads in the previous epoch and observes zero while the total number of threads is greater than zero, then this thread is responsible for the epoch change. The decrement of the last thread in the previous epoch and the epoch bump may happen in a single step, in which case nobody will observe zero threads in the previous epoch. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="ab46c5fe15d36c12d619713e696a48626" name="ab46c5fe15d36c12d619713e696a48626"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab46c5fe15d36c12d619713e696a48626">&#9670;&#160;</a></span>atomic_fetch_dec_threads_in_previous_epoch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structunodb_1_1qsbr__state.html#a9ded9024be69a382b3a9fc65892ea7cc">qsbr_state::type</a> unodb::qsbr_state::atomic_fetch_dec_threads_in_previous_epoch </td>
          <td>(</td>
          <td class="paramtype">std::atomic&lt; <a class="el" href="structunodb_1_1qsbr__state.html#a9ded9024be69a382b3a9fc65892ea7cc">type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>word</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Atomically decrement the number of threads in the previous epoch. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">word</td><td>atomic QSBR state word </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>old word value </dd></dl>

</div>
</div>
<hr/>The documentation for this struct was generated from the following files:<ul>
<li><a class="el" href="qsbr_8hpp_source.html">qsbr.hpp</a></li>
<li><a class="el" href="qsbr_8cpp.html">qsbr.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceunodb.html">unodb</a></li><li class="navelem"><a class="el" href="structunodb_1_1qsbr__state.html">qsbr_state</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
